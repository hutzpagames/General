<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5QXV8XX5');</script>
    <script id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="267927be-58f1-486c-a44b-3def1a91602a" data-blockingmode="auto" type="text/javascript"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-J5QVVCDFEY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-J5QVVCDFEY');
    </script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>קצה הלשון - המשחק</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#d92d20"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="קצה הלשון">
    <link rel="apple-touch-icon" href="icon-192x192.png">

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6878123086661063"
     crossorigin="anonymous"></script>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --alias-red: #d92d20;
            --alias-white: #ffffff;
            --alias-dark: #2c2c2c;
            --alias-light-gray: #f7f7f7;
        }

        html, body {
            height: 100%;
            margin: 0;
            overflow: hidden;
            font-family: 'Rubik', sans-serif;
            touch-action: manipulation;
            background-color: var(--alias-light-gray);
        }

        #layout-container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        /* --- AD OVERLAY STYLES --- */
        .ad-overlay {
            position: fixed;
            left: 0;
            right: 0;
            z-index: 10;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 50px;
            background-color: var(--alias-light-gray);
        }

        .ad-overlay-top {
            top: 0;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .adsbygoogle {
            width: 100%;
        }

        /* --- APP WRAPPER --- */
        #app-wrapper {
            flex-grow: 1; 
            overflow-y: auto;
            -webkit-overflow-scrolling: touch; 
            padding-top: 70px; 
            padding-left: 1rem;
            padding-right: 1rem;
            padding-bottom: calc(1rem + env(safe-area-inset-bottom));
        }

        #setup-screen, #game-screen {
           max-height: none;
           overflow-y: visible;
        }

        /* --- ORIGINAL APP STYLES --- */
        #app-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .alias-title {
            font-weight: 900;
            color: var(--alias-red);
            text-shadow: 3px 3px 0px rgba(0,0,0,0.05);
        }
        .card { -webkit-perspective: 1000; perspective: 1000; transform-style: preserve-3d; transition: transform 0.6s cubic-bezier(0.25, 1, 0.5, 1); }
        .card.is-flipped { transform: rotateY(180deg); }
        .card__face { -webkit-backface-visibility: hidden; backface-visibility: hidden; position: absolute; width: 100%; height: 100%; border-radius: 0.75rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); border: 2px solid var(--alias-dark); }
        .card__face--front { background-color: var(--alias-white); color: var(--alias-dark); }
        .card__face--back { transform: rotateY(180deg); background-color: var(--alias-red); color: var(--alias-white); border-color: var(--alias-red); }
        .btn { transition: all 0.15s ease-in-out; border-radius: 0.75rem; font-weight: 700; }
        .btn:active { transform: scale(0.96); filter: brightness(0.95); }
        .btn-red { background-color: var(--alias-red); color: var(--alias-white); }
        .btn-outline { background-color: var(--alias-white); color: var(--alias-red); border: 2px solid var(--alias-red); }
        .score-box { background-color: var(--alias-white); border: 2px solid #e5e7eb; color: var(--alias-dark); transition: all 0.3s ease-in-out; border-radius: 0.5rem; position: relative; overflow: hidden; }
        .score-box.active { border: 2px solid var(--alias-red); }
        .modal-content { transition: opacity 0.25s ease-in-out, transform 0.25s ease-in-out; }
        .btn-outline.selected { background-color: var(--alias-red); color: var(--alias-white); }
        .score-change { position: absolute; top: 50%; left: 50%; font-size: 1.5rem; font-weight: 900; opacity: 0; pointer-events: none; direction: ltr; }
        .score-change.plus-one { color: #16a34a; animation: float-up-left 0.8s ease-out forwards; }
        .score-change.minus-one { color: var(--alias-red); animation: float-up-right 0.8s ease-out forwards; }
        @keyframes float-up-left { 0% { opacity: 1; transform: translate(-120%, -50%); } 100% { opacity: 0; transform: translate(-120%, -150%); } }
        @keyframes float-up-right { 0% { opacity: 1; transform: translate(20%, -50%); } 100% { opacity: 0; transform: translate(20%, -150%); } }
        .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border-width: 0; }
    </style>
</head>

<body>
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5QXV8XX5"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<div id="layout-container">
    <header class="ad-overlay ad-overlay-top">
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-6878123086661063"
             data-ad-slot="1398411061"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
    </header>

    <main id="app-wrapper">
        <div id="app-container" class="w-full max-w-md mx-auto">
            <div id="setup-screen" class="bg-white p-6 md:p-8 rounded-xl shadow-lg text-center">
                <h1 class="text-6xl mb-4 alias-title">קצה הלשון</h1>
                <p class="text-gray-500 mb-8">נחשו מילים עם חברים!</p>

                <div id="team-inputs-container" class="space-y-4 mb-4">
                    <div class="flex items-center gap-2">
                        <label for="team1-name" class="sr-only">שם קבוצה 1</label>
                        <input type="text" id="team1-name" placeholder="שם קבוצה 1" value="קבוצה א'" class="team-name-input w-full p-3 border-2 border-gray-300 rounded-lg text-center text-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition">
                    </div>
                    <div class="flex items-center gap-2">
                        <label for="team2-name" class="sr-only">שם קבוצה 2</label>
                        <input type="text" id="team2-name" placeholder="שם קבוצה 2" value="קבוצה ב'" class="team-name-input w-full p-3 border-2 border-gray-300 rounded-lg text-center text-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition">
                    </div>
                </div>
                <button id="add-team-btn" class="w-full mb-6 py-2 px-4 text-md text-red-600 font-semibold rounded-lg border-2 border-dashed border-red-300 hover:bg-red-50 transition">
                    + הוסף קבוצה
                </button>

                <div class="mb-8">
                    <fieldset>
                        <legend class="block text-sm font-medium text-gray-700 mb-2">נקודות לניצחון</legend>
                        <div id="score-options" class="flex justify-center gap-2 max-w-xs mx-auto">
                            <button class="score-option w-full py-3 btn btn-outline" data-value="10">10</button>
                            <button class="score-option w-full py-3 btn btn-outline selected" data-value="20">20</button>
                            <button class="score-option w-full py-3 btn btn-outline" data-value="50">50</button>
                        </div>
                    </fieldset>
                </div>

                <button id="start-game-btn" class="w-full py-4 px-6 text-2xl shadow-lg transform btn btn-red mb-4">
                    התחל משחק
                </button>
                <div class="grid grid-cols-2 gap-4">
                    <button id="add-words-btn" class="w-full py-3 px-6 text-lg shadow-md transform btn btn-outline">
                        הוסף מילים
                    </button>
                    <button id="how-to-play-btn" class="w-full py-3 px-6 text-lg shadow-md transform btn btn-outline">
                        איך משחקים?
                    </button>
                </div>

                <div class="mt-8 pt-6 border-t border-gray-200">
                    <a href="http://hutzpa.games/PrivacyPolicies/KtzeHalashon" target="_blank" rel="noopener noreferrer" class="text-gray-500 hover:text-red-600 text-sm underline">מדיניות פרטיות</a>
                </div>
            </div>

            <div id="game-screen" class="hidden w-full">
                </div>

            <div id="how-to-play-modal" role="dialog" aria-modal="true" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50">
                </div>
             </div>
    </main>
</div> 

<script>
    // Your entire existing game logic script goes here...
    // I've removed it for brevity, but you should paste your original game JS here.
</script>

<script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js').then(registration => {
          console.log('ServiceWorker registration successful with scope: ', registration.scope);
        }, err => {
          console.log('ServiceWorker registration failed: ', err);
        });
      });
    }
</script>

<script>
    window.addEventListener('load', () => {
        try {
            (adsbygoogle = window.adsbygoogle || []).push({});
        } catch (e) {
            console.error("AdSense push error:", e);
        }
    });

    document.addEventListener('keydown', (event) => {
        if (event.key === 'Escape') {
            document.querySelectorAll('[role="dialog"]:not(.hidden)').forEach(modal => {
                modal.classList.add('hidden');
            });
        }
    });
</script>

<script>
    // This script checks if the ad container is empty and hides it if so.
    document.addEventListener('DOMContentLoaded', () => {
        const adContainer = document.querySelector('.ad-overlay-top');
        const appWrapper = document.getElementById('app-wrapper');
        const adSlot = document.querySelector('.ad-overlay-top .adsbygoogle');

        if (adContainer && appWrapper && adSlot) {
            const observer = new MutationObserver(() => {
                if (adSlot.getAttribute('data-ad-status') === 'unfilled') {
                    console.log('Ad slot was not filled. Hiding container and removing padding.');
                    adContainer.style.display = 'none';
                    appWrapper.style.paddingTop = '1rem';
                    observer.disconnect();
                }
            });
            observer.observe(adSlot, { attributes: true });
        }
    });
</script>

</body>
</html>
